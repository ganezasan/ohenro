function S4(){return((1+Math.random())*65536|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}function Sync(e,t,n){var r=e.config.adapter.collection_name?e.config.adapter.collection_name:"default",i=new RegExp("^("+r+")\\-(.+)$"),s=null;if(t==="read")if(n.parse){var o=[];_.each(TAP.listProperties(),function(e){var t=e.match(i);t!==null&&o.push(TAP.getObject(e))}),e.reset(o),s=o}else{var u=TAP.getObject(r+"-"+e.id);e.set(u),s=e.toJSON()}else t==="create"||t==="update"?(e.id||(e.id=guid(),e.set(e.idAttribute,e.id)),TAP.setObject(r+"-"+e.id,e.toJSON()||{}),s=e.toJSON()):t==="delete"&&(TAP.removeProperty(r+"-"+e.id),e.clear(),s=e.toJSON());s?(_.isFunction(n.success)&&n.success(s),t==="read"&&e.trigger("fetch")):_.isFunction(n.error)&&n.error("Record not found")}var Alloy=require("alloy"),_=require("alloy/underscore")._,TAP=Ti.App.Properties;module.exports.sync=Sync,module.exports.beforeModelCreate=function(e){e=e||{},e.columns=e.columns||{},e.defaults=e.defaults||{};if(typeof e.columns.id=="undefined"||e.columns.id===null)e.columns.id="String";return e}