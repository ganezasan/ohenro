var path_lib="";Ti.Platform.osname=="iphone"&&Ti.version<"1.7.0"&&(path_lib="lib/"),Ti.include(path_lib+"sha1.js"),Ti.include(path_lib+"oauth.js"),Ti.include(path_lib+"oauth_adapter.js");var TwitterApi=function(e){var t=this,n=e.consumerSecret,r=e.consumerKey,i=e.signatureMethod||"HMAC-SHA1";this.oAuthAdapter=new OAuthAdapter(n,r,i,{useQueue:!1}),this.init=function(e){var t=this.oAuthAdapter;t.loadAccessToken("twitter");if(t.isAuthorized()==0){var n=function(){t.getAccessToken("https://api.twitter.com/oauth/access_token",function(){t.saveAccessToken("twitter")})};t.getRequestToken("https://api.twitter.com/oauth/request_token",function(e){e&&t.showAuthorizeUI("https://api.twitter.com/oauth/authorize?"+e,n)})}},this._callApi=function(e){var t=e.url.match(/:[^\/\.]+/g);if(t){for(var n=0;n<t.length;n++){var r=t[n].replace(":","");e[r]&&(e.url=e.url.replace(t[n],e[r]),delete e[r])}Ti.API.debug("replaced"),Ti.API.debug(e)}var i=[];for(var r in e){if("url"==r)continue;if("method"==r)continue;if("onSuccess"==r)continue;if("onError"==r)continue;if("parameters"==r){for(var s in e.parameters)i.push([s,e.parameters[s]]);continue}i.push([r,e[r]])}var o=this.oAuthAdapter;o.loadAccessToken("twitter");var u=o.send({url:e.url,parameters:i,method:e.method,onSuccess:function(t){t=JSON.parse(t),e&&e.onSuccess?e.onSuccess(t):Ti.API.error("no success handler")},onError:function(t){e.onError?e.onError(t):(Ti.API.error("no error handler"),Ti.API.error(t))}})},this.callApi=function(e){if(!e)return Ti.API.error("twitter api params error. no params."),!1;if(!e.url)return Ti.API.error("twitter api params error. no params.url."),!1;if(this.oAuthAdapter.isAuthorized())return t._callApi(e);setTimeout(function(){t.callApi(e)},1e3)},this.clear_accesstoken=function(){t.oAuthAdapter.clearAccessToken("twitter")},this.clear_actionsqueue=function(){t.oAuthAdapter.clearActionsQueue()},this.isAuthorized=function(){var e=this.oAuthAdapter;return e.loadAccessToken("twitter"),e.isAuthorized()==0?!1:!0},this.statuses_public_timeline=function(e){return e.url="https://api.twitter.com/1/statuses/public_timeline.json",e.method="GET",t.callApi(e)},this.statuses_home_timeline=function(e){return e.url="https://api.twitter.com/1/statuses/home_timeline.json",e.method="GET",t.callApi(e)},this.statuses_friends_timeline=function(e){return e.url="https://api.twitter.com/1/statuses/friends_timeline.json",e.method="GET",t.callApi(e)},this.statuses_user_timeline=function(e){return e.url="https://api.twitter.com/1/statuses/user_timeline.json",e.method="GET",t.callApi(e)},this.statuses_mentions=function(e){return e.url="https://api.twitter.com/1/statuses/mentions.json",e.method="GET",t.callApi(e)},this.statuses_retweeted_by_me=function(e){return e.url="https://api.twitter.com/1/statuses/retweeted_by_me.json",e.method="GET",t.callApi(e)},this.statuses_retweeted_to_me=function(e){return e.url="https://api.twitter.com/1/statuses/retweeted_to_me.json",e.method="GET",t.callApi(e)},this.statuses_show=function(e){return e.url="https://api.twitter.com/1/statuses/show/:id.json",e.method="GET",t.callApi(e)},this.statuses_update=function(e){return e.url="https://api.twitter.com/1/statuses/update.json",e.method="POST",t.callApi(e)},this.statuses_destroy=function(e){return e.url="https://api.twitter.com/1/statuses/destroy/:id.json",e.method="POST",t.callApi(e)},this.statuses_retweet=function(e){return e.url="https://api.twitter.com/1/statuses/retweet/:id.json",e.method="POST",t.callApi(e)},this.statuses_retweets=function(e){return e.url="https://api.twitter.com/1/statuses/retweets/:id.json",e.method="GET",t.callApi(e)},this.statuses_retweeted_by=function(e){return e.url="https://api.twitter.com/1/statuses/:id/retweeted_by.json",e.method="GET",t.callApi(e)},this.statuses_retweeted_by_ids=function(e){return e.url="https://api.twitter.com/1/statuses/:id/retweeted_by/:ids.json",e.method="GET",t.callApi(e)},this.users_show=function(e){return e.url="https://api.twitter.com/1/users/show.json",e.method="GET",t.callApi(e)},this.users_lookup=function(e){return e.url="https://api.twitter.com/1/users/lookup.json",e.method="GET",t.callApi(e)},this.users_search=function(e){return e.url="https://api.twitter.com/1/users/search.json",e.method="GET",t.callApi(e)},this.users_suggestions=function(e){return e.url="https://api.twitter.com/1/users/suggestions.json",e.method="GET",t.callApi(e)},this.users_suggestions_twitter=function(e){return e.url="https://api.twitter.com/1/users/suggestions/:slug.json",e.method="GET",t.callApi(e)},this.users_profile_image_twitter=function(e){return e.url="https://api.twitter.com/1/users/profile_image/:screen_name.json",e.method="GET",t.callApi(e)},this.statuses_friends=function(e){return e.url="https://api.twitter.com/1/statuses/friends.json",e.method="GET",t.callApi(e)},this.statuses_followers=function(e){return e.url="https://api.twitter.com/1/statuses/followers.json",e.method="GET",t.callApi(e)},this.trends=function(e){return e.url="https://api.twitter.com/1/trends.json",e.method="GET",t.callApi(e)},this.trends_current=function(e){return e.url="https://api.twitter.com/1/trends/current.json",e.method="GET",t.callApi(e)},this.trends_daily=function(e){return e.url="https://api.twitter.com/1/trends/daily.json",e.method="GET",t.callApi(e)},this.trends_weekly=function(e){return e.url="https://api.twitter.com/1/trends/weekly.json",e.method="GET",t.callApi(e)},this.user_lists_create=function(e){e.url="https://api.twitter.com/1/:user/lists.json",e.method="POST"},this.user_lists_update=function(e){e.url="https://api.twitter.com/1/:user/lists/:id.json",e.method="POST"},this.user_lists_of_user=function(e){e.url="https://api.twitter.com/1/:user/lists.json",e.method="GET"},this.user_lists_get=function(e){e.url="https://api.twitter.com/1/:user/lists/:id.json",e.method="GET"},this.user_lists_delete=function(e){e.url="https://api.twitter.com/1/:user/lists/:id.json",e.method="POST",e._method="DELETE"},this.user_lists_statuses=function(e){e.url="https://api.twitter.com/1/:user/lists/:id/statuses.json",e.method="GET"},this.user_lists_memberships=function(e){e.url="https://api.twitter.com/1/:user/lists/memberships.json",e.method="GET"},this.user_lists_subscriptions=function(e){e.url="https://api.twitter.com/1/:user/lists/subscriptions.json",e.method="GET"},this.direct_messages=function(e){return e.url="https://api.twitter.com/1/direct_messages.json",e.method="GET",t.callApi(e)},this.direct_messages_sent=function(e){return e.url="https://api.twitter.com/1/direct_messages/sent.json",e.method="GET",t.callApi(e)},this.direct_messages_new=function(e){return e.url="https://api.twitter.com/1/direct_messages/new.json",e.method="POST",t.callApi(e)},this.friendships_create=function(e){return e.url="https://api.twitter.com/1/friendships/create.json",e.method="GET",t.callApi(e)},this.friendships_destroy=function(e){return e.url="https://api.twitter.com/1/friendships/destroy/:id.json",e.method="GET",t.callApi(e)},this.friendships_exists=function(e){return e.url="https://api.twitter.com/1/friendships/exists.json",e.method="GET",t.callApi(e)},this.friendships_show=function(e){return e.url="https://api.twitter.com/1/friendships/show.json",e.method="GET",t.callApi(e)},this.friendships_incoming=function(e){return e.url="https://api.twitter.com/1/friendships/incoming.json",e.method="GET",t.callApi(e)},this.account_verify_credentials=function(e){return e.url="https://api.twitter.com/1/account/verify_credentials.json",e.method="GET",t.callApi(e)},this.account_rate_limit_status=function(e){return e.url="https://api.twitter.com/1/account/rate_limit_status.json",e.method="GET",t.callApi(e)},this.account_end_session=function(e){return e.url="https://api.twitter.com/1/account/end_session.json",e.method="POST",t.callApi(e)},this.account_update_delivery_device=function(e){return e.url="https://api.twitter.com/1/account/update_delivery_device.json",e.method="POST",t.callApi(e)},this.account_update_profile_colors=function(e){return e.url="https://api.twitter.com/1/account/update_profile_colors.json",e.method="POST",t.callApi(e)},this.account_update_profile_image=function(e){return e.url="https://api.twitter.com/1/account/update_profile_image.json",e.method="POST",t.callApi(e)},this.account_update_profile_background_image=function(e){return e.url="https://api.twitter.com/1/account/update_profile_background_image.json",e.method="POST",t.callApi(e)},this.favorites=function(e){return e.url="https://api.twitter.com/1/favorites.json",e.method="GET",t.callApi(e)},this.favorites_create=function(e){return e.url="https://api.twitter.com/1/favorites/create/:id.json",e.method="POST",t.callApi(e)},this.favorites_destroy=function(e){return e.url="https://api.twitter.com/1/favorites/destroy:id.json",e.method="POST",t.callApi(e)},this.blocks_create=function(e){return e.url="https://api.twitter.com/1/blocks/create.json",e.method="POST",t.callApi(e)},this.blocks_destroy=function(e){return e.url="https://api.twitter.com/1/blocks/destroy.json",e.method="POST",t.callApi(e)},this.blocks_exists=function(e){return e.url="https://api.twitter.com/1/blocks/exists.json",e.method="GET",t.callApi(e)},this.blocks_blocking=function(e){return e.url="https://api.twitter.com/1/blocks/blocking.json",e.method="GET",t.callApi(e)},this.blocks_blocking_ids=function(e){return e.url="https://api.twitter.com/1/blocks/blocking/:ids.json",e.method="GET",t.callApi(e)},this.report_spam=function(e){return e.url="https://api.twitter.com/1/report_spam.json",e.method="POST",t.callApi(e)},this.saved_searches=function(e){return e.url="https://api.twitter.com/1/saved_searches.json",e.method="GET",t.callApi(e)},this.saved_searches_show=function(e){return e.url="https://api.twitter.com/1/saved_searches/show.json",e.method="GET",t.callApi(e)},this.saved_searches_create=function(e){return e.url="https://api.twitter.com/1/saved_searches/create.json",e.method="POST",t.callApi(e)},this.saved_searches_delete=function(e){return e.url="https://api.twitter.com/1/saved_searches/destroy.json",e.method="POST",t.callApi(e)},this.geo_search=function(e){return e.url="https://api.twitter.com/1/geo/search.json",e.method="GET",t.callApi(e)},this.geo_similar_places=function(e){return e.url="https://api.twitter.com/1/geo/similar_places.json",e.method="GET",t.callApi(e)},this.geo_reverse_geocode=function(e){return e.url="https://api.twitter.com/1/geo/reverse_geocode.json",e.method="GET",t.callApi(e)},this.geo_id_place=function(e){return e.url="https://api.twitter.com/1/geo/id/:place_id.json",e.method="GET",t.callApi(e)}}